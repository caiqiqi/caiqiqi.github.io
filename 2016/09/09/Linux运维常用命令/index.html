<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="陛下，您真是一位老太太">
    <meta name="keyword"  content="undefined">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
          Linux运维常用命令 - shasock5
        
    </title>

    <link rel="canonical" href="https://github.com/caiqiqi/2016/09/09/Linux运维常用命令/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">nobody from nowhere</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    
<!-- Image to hack wechat -->
<!-- <img src="https://github.com/caiqiqi/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="{{ site.baseurl }}/{% if page.header-img %}{{ page.header-img }}{% else %}{{ site.header-img }}{% endif %}" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/home-bg.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                          <a class="tag" href="/tags/#Linux" title="Linux">Linux</a>
                        
                    </div>
                    <h1>Linux运维常用命令</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Posted by nobody from nowhere on
                        2016-09-09
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <p>参考：<br><a href="https://wiki.tankywoo.com/linux/linux_tips.html" target="_blank" rel="external">https://wiki.tankywoo.com/linux/linux_tips.html</a><br><a href="https://wiki.tankywoo.com/linux/linux_network_config.html" target="_blank" rel="external">https://wiki.tankywoo.com/linux/linux_network_config.html</a></p>
<h1 id="w"><a href="#w" class="headerlink" title="w"></a>w</h1><p><strong>display who is logged in and what they are doing</strong><br><img src="http://img.blog.csdn.net/20160801031459354" alt="这里写图片描述"></p>
<blockquote>
<p>The w utility prints a summary of the current activity on the system, including what each user is doing.  The first line displays the current time of day, how long the system has been running, the number of users logged into the system, and the load averages.  The load average numbers give the number of jobs in the run queue averaged over 1, 5 and 15 minutes.<br>    The fields output are the user’s login name, the name of the terminal the user is on, the host from which the user is logged in, the time the user logged on, the time since the user last typed anything, and the name and arguments of the current process.</p>
</blockquote>
<h1 id="top-htop"><a href="#top-htop" class="headerlink" title="top/htop"></a>top/htop</h1><p><strong>查看进程和CPU状态</strong><br><img src="http://img.blog.csdn.net/20160801031912433" alt="这里写图片描述"></p>
<blockquote>
<p>It  is  similar  to top, but allows you to scroll vertically and horizontally, so you can see all the processes running on the system, along with their full command lines</p>
</blockquote>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p><code>man ps</code>可以看到各个进程状态的解释，查看进程状态是否有<code>D</code>，表示在等待IO。<br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> date; ps auxf | awk <span class="string">'&#123;if($8=="S") print $0;&#125;'</span>; sleep 1; <span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<p>或者<br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> `seq 1 1 10`; <span class="keyword">do</span> ps -eo state,pid,cmd | grep <span class="string">"^D"</span>; <span class="built_in">echo</span> <span class="string">"----"</span>; sleep 1; <span class="keyword">done</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>其实工具都只是表层, 最底层的还是读取/proc下的文件, 具体在每个工具的man手册都有介绍。<br>还有一个比较强大的工具dstat, 集合了vmstat, iostat, ifstat等工具的功能, 并且输出是颜色高亮</p>
</blockquote>
<p><img src="http://img.blog.csdn.net/20160801033134751" alt="这里写图片描述"></p>
<h2 id="CPU使用最高的三个进程-Linux"><a href="#CPU使用最高的三个进程-Linux" class="headerlink" title="CPU使用最高的三个进程(Linux)"></a>CPU使用最高的三个进程(Linux)</h2><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">ps -auxf | sort -nr -k 3 | head -3</div></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20160801033506846" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20160801033645821" alt="这里写图片描述"></p>
<h2 id="查看本机最常用的10条命令"><a href="#查看本机最常用的10条命令" class="headerlink" title="查看本机最常用的10条命令"></a>查看本机最常用的10条命令</h2><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="built_in">history</span> | awk <span class="string">'&#123;a[$2]++&#125;END&#123;for(i in a)&#123;print a[i] " " i&#125;&#125;'</span> | sort -rn | head</div></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20160801033950865" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20160801035338355" alt="这里写图片描述"></p>
<h2 id="统计当前目录下（包括子目录）以-py结尾文件的个数及总代码行数"><a href="#统计当前目录下（包括子目录）以-py结尾文件的个数及总代码行数" class="headerlink" title="统计当前目录下（包括子目录）以.py结尾文件的个数及总代码行数"></a>统计当前目录下（包括子目录）以.py结尾文件的个数及总代码行数</h2><p><strong>文件个数</strong><br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">find . -name <span class="string">"*.py"</span> | wc <span class="_">-l</span></div></pre></td></tr></table></figure></p>
<p><strong>单个文件代码行数及总行数</strong><br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">find . -name <span class="string">"*.py"</span> | xargs wc <span class="_">-l</span></div></pre></td></tr></table></figure></p>
<p><strong>输出错误重定向(不想看到错误输出到屏幕)</strong><br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">ls 1&gt;/dev/null 2&gt;/dev/null</div><div class="line">ls &gt;/dev/null 2&gt;&amp;1</div></pre></td></tr></table></figure></p>
<p><strong>显示没个远程IP与本地的连接数</strong><br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">netstat -antu | awk <span class="string">'$5 ~ /[0-9]:/&#123;split($5, a, ":"); ips[a[1]]++&#125; END &#123;for (ip in ips) print ips[ip], ip | "sort -k1 -nr"&#125;'</span></div></pre></td></tr></table></figure></p>
<p><strong>替换上条命令的关键字并执行</strong><br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment"># 将上一条命令的pint换成traceroute</span></div><div class="line">^ping^traceroute^</div></pre></td></tr></table></figure></p>
<p><strong>搜索最近一条符合关键字的命令</strong><br>比如上面执行过命令是ping wutianqi.com, 想再执行, 可以<br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="comment">#p是关键字, 也可以 pi, pin, ping都行</span></div><div class="line">!p</div></pre></td></tr></table></figure></p>
<h2 id="网络配置相关"><a href="#网络配置相关" class="headerlink" title="网络配置相关"></a>网络配置相关</h2><p><strong>直接用ifconfig配置</strong><br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">设置网卡eth0的IP地址和子网掩码</div><div class="line">sudo ifconfig eth0 192.168.2.106 netmask 255.255.255.0</div><div class="line">设置网关</div><div class="line">sudo route add default gw 192.168.2.254</div><div class="line">配置DNS</div><div class="line">sudo vim /etc/resolv.conf</div></pre></td></tr></table></figure></p>
<p><strong>ubuntu 网络配置文件</strong><br><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">sudo vim /etc/network/interfaces</div><div class="line"></div><div class="line">DHCP连接</div><div class="line">auto eth0</div><div class="line">iface eth0 inet dhcp</div><div class="line"></div><div class="line">手动配置静态ip</div><div class="line">auto eth0</div><div class="line">iface eth0 inet static</div><div class="line">address 192.169.2.106</div><div class="line">gateway 192.168.2.254</div><div class="line">netmask 255.255.255.0</div><div class="line"><span class="comment">#network ?.?.?.?</span></div><div class="line"><span class="comment">#broadcast ?.?.?.?</span></div><div class="line"></div><div class="line"><span class="comment">#dns设置</span></div><div class="line"><span class="comment">#我印象中重启后resolv.conf的内容会删除</span></div><div class="line"><span class="comment">#所以DNS服务器的配置也是在/etc/network/interfaces下</span></div><div class="line">dns-nameservers 8.8.8.8</div><div class="line">dns-search xxx.xxx.xxx...</div><div class="line"></div><div class="line"><span class="comment">#添加一条静态路由</span></div><div class="line">up route add -net 192.0.0.0/8 gw 192.0.0.1 dev eth0</div></pre></td></tr></table></figure></p>


                <hr>

                

                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2016/09/09/ns3-HOWTO-understand-and-find-cause-of-terminated-with-signal-errors/" data-toggle="tooltip" data-placement="top" title="ns3--HOWTO understand and find cause of terminated with signal errors">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2016/09/09/体验ImageMagick-命令执行漏洞-CVE-2016–3714-的PoC/" data-toggle="tooltip" data-placement="top" title="体验ImageMagick 命令执行漏洞(CVE-2016–3714)的PoC">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                

                

            </div>
    <!-- Side Catalog Container -->
        

    <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Linux" title="Linux">Linux</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>

        </div>
    </div>
</article>









    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/2963784630">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/caiqiqi">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; nobody from nowhere 2018 
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    Ported by <a href="http://blog.kaijun.rocks">Kaijun</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=kaijun&repo=hexo-theme-huxblog&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://github.com/caiqiqi/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->


<!-- Side Catalog -->




<!-- Image to hack wechat -->
<img src="https://github.com/caiqiqi/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
